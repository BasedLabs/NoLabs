name: nolabs
run-name: nolabs

# Build and push nolabs image using GitHub Cache API
# Only if relevant files were changed

on:
  push:
    branches:
      - master
    paths:
      - 'build/**'
      - 'client/**'
      - 'frontend/**'
      - 'nolabs/**'
      - 'build/**'
      - 'pyproject.toml'
      - 'poetry.toml'

jobs:
  build-and-push:
    if: github.repository == 'BasedLabs/NoLabs'

    permissions:
      contents: read
      packages: write

    uses: ./.github/workflows/build-and-push-image.yaml
    with:
      microservice_name: "nolabs"
      push: true
